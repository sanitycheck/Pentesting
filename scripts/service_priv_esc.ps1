# Author: Dustin Mallory
# Name: service_priv_esc
# Version: 1.0
# Description: This powershell script is designed with the intent to help identify weak permissions on misconfigured services
# which an attacker could use to escalate their privileges.
#
# CHANGE LOG
# Author           Date         Description
# Dustin Mallory | 02/02/2019 | Assists in identifying weak permssions on misconfigured services
#
$prevErrorActionPreference = $ErrorActionPreference
$ErrorActionPreference = "silentlycontinue"

Get-WmiObject win32_service | 
ForEach-Object {
    $servicePath = ( $_.PathName.Replace('"','').Substring(0, $_.PathName.Replace('"','').IndexOf(".exe"))+".exe");
    $acl=Get-Acl $servicePath;
    if(!$acl.Path.EndsWith("svchost.exe")){
    $acl | fl
    }
}
$ErrorActionPreference = $prevErrorActionPreference
